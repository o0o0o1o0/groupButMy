<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>創建指南 | 夜市客</title>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js'></script>
  <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/08520791a5.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/js/all.js'></script> -->
    <script src="./js/create.js"></script>


  <style>
    @import url(./css/style.css);
    /* @import url(./path/css/fontawesome.css); */
    #create .container{
      margin-top: 100px;
    }
  </style>
</head>
<body id="create">
  <div class="navmenu">
    <div class="wrap">
      <div class="logo">
        <div class="img">
          <a href="./index.html"><img src="./img/layout/logo.png"></a>
        </div>
      </div>
      <div>
        <ul class="navlist">
          <li><a href="./book.html">食玩圖鑑</a></li>
          <li><a href="./guide.html">食玩指南</a></li>
          <li><a href="./game.html">食尚玩家</a></li>
          <li><a href="./ad.html">夜市新鮮事</a></li>
          <li><a href="./create.html">創建指南</a></li>
          </ul>
          <div class="rIcon">
            <button class="hamburger hamburger--squeeze" type="button">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
            <!--<a href=""class="hamburger"><i class="fas fa-bars bar-open"></i></a>-->
            <a href="#"class="user"><i class="fas fa-user"></i></a>
            <a href="#"class="cart"><i class="fas fa-shopping-cart"></i></a>
          </div>
      </div>
    </div>
  </div>
  <div class="container">
    <!--第二步新增的放在form外面才不會被送出-->
    <div class="meal" style="display:none;">
      <div class="putmealhere">
        <input type="file" name="" id="">
        <label for=""><span>上傳圖片</span></label>
        <img src="" alt="" class="showMyMeal">
      </div>
      <div class="mealtextwrap">
        <label for=""><input type="text"placeholder="商品名稱"required="required"></label>
        <label for=""><input type="text"placeholder="商品價位"required="required"></label>
        <div class="selectwrap">
          <div class="selectcontrol"><span>商品類型</span></div>
          <div class="selectnav">
            <label for=""><input type="radio" name="" value="A1"data-text="炸的"><span>炸的</span></label>
            <label for=""><input type="radio" name="" value="A2"data-text="滷的"><span>滷的</span></label>
            <label for=""><input type="radio" name="" value="A3"data-text="烤的"><span>烤的</span></label>
            <label for=""><input type="radio" name="" value="A4"data-text="其他吃的"><span>其他吃的</span></label>
            <label for=""><input type="radio" name="" value="B1"data-text="茶類"><span>茶類</span></label>
            <label for=""><input type="radio" name="" value="B2"data-text="果汁類"><span>果汁類</span></label>
            <label for=""><input type="radio" name="" value="B3"data-text="其他喝的"><span>其他喝的</span></label>
            <label for=""><input type="radio" name="" value="C1"data-text="遊戲"><span>遊戲</span></label>
          </div>
        </div>
        <button type="button"class="deleteBtn">X</button>
      </div>
    </div>
    <!--↑第二步新增的放在form外面才不會被送出-->
    <form action="這裡打上php的名字.php" id="createVendor" data-page='1'>
      <div class="steps">
        <div class="top">
          <div class="stepwrap" data-page="1">
            <!-- <img src="./img/gray.png" alt=""> -->
            <div class="info">
              <div class="num">01</div>
              <div class="text">建立<br>店家資料</div>
            </div>
          </div>
          <div></div>
          <div class="stepwrap" data-page="3">
            <!-- <img src="./img/gray.png" alt=""> -->
            <div class="info">
              <div class="num">03</div>
              <div class="text">建立<br>地圖位置</div>
            </div>
          </div>
          <div></div>
          <div class="stepwrap" data-page="5">
            <!-- <img src="./img/gray.png" alt=""> -->
            <div class="info">
              <div class="num">05</div>
              <div class="text">&nbsp&nbsp&nbsp完成！</div>
            </div>
          </div>
        </div>
        <div class="mid">
          <img class="stepline"src="./img/create/line.png" alt="">
        </div>
        <div class="bom">
          <div></div>
          <div class="stepwrap"data-page="4">
            <!-- <img src="./img/gray.png" alt=""> -->
            <div class="info">
              <div class="num">04</div>
              <div class="text">檢視<br>資料</div>
            </div>
          </div>
          <div></div>
          <div class="stepwrap"data-page="2">
            <!-- <img src="./img/gray.png" alt=""> -->
            <div class="info">
              <div class="num">02</div>
              <div class="text">建立<br>菜單</div>
            </div>
          </div>
          <div></div>
        </div>
      </div>
      <div class="pagewrap">
        <div class="page page1">
          <h2>建立店家資料</h2>
          <div class="pageItem">
            <div>
              <div>
                <h3>輸入攤位名稱</h3>
                <input type="text" required="required">
              </div>
  <!--             <div>
                <h3>店家類型（可複選）</h3>
                <div class="selectwrap">
                  <div class="selectcontrol">選擇類型</div>
                  <div class="selectnav"><label for=""><input type="checkbox" name="" id=""></label></div>
                </div>
              </div> -->
              <div>
                <h3>營業時間（可複選）</h3>
                <div class="selectwrap">
                  <div class="selectcontrol"><span>選擇星期</span></div>
                  <div class="selectnav">
                    <label for="weekselect"><input type="checkbox"id="weekselect"class="selectAll">全選</label>
                    <label for="mon"><input type="checkbox" name="week[]" id="mon"data-text="一">星期一</label>
                    <label for="tue"><input type="checkbox" name="week[]" id="tue"data-text="二">星期二</label>
                    <label for="wed"><input type="checkbox" name="week[]" id="wed"data-text="三">星期三</label>
                    <label for="thu"><input type="checkbox" name="week[]" id="thu"data-text="四">星期四</label>
                    <label for="fri"><input type="checkbox" name="week[]" id="fri"data-text="五">星期五</label>
                    <label for="sat"><input type="checkbox" name="week[]" id="sat"data-text="六">星期六</label>
                    <label for="sun"><input type="checkbox" name="week[]" id="sun"data-text="日">星期日</label>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div>
                <h3>輸入店家簡介</h3>
                <textarea name="" id="" cols="" rows=""placeholder="最多輸入30字" maxlength="30"></textarea>
              </div>
              <div>
                <h3>上傳店家頭貼</h3>
                <div class="putheadhere">
                  <label for="myHead"><span class="btn-cir_bl">上傳</span></label>
                  <input type="file" name="" id="myHead">
                  <img class="showMyHead">
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="page page2">
          <h2>建立菜單</h2>
          <div class="pageItem"> 
            <!-- <div class="mealNote">
              <p>上傳圖片</p>
              <p>商品名稱</p>
              <p>商品價位</p>
              <p>商品類型</p>
              <p>刪除</p>
            </div> -->
            <div class="addBtn">
              <label for="addBtn">+</label>
              <input type="button" value="新增" id="addBtn" onclick="addMeal()">
            </div>
            
            
          </div>
        </div>
        <div class="page page3">
          <h2>建立地圖位置</h2>
          <div class="pageItem">
            <div id="map"></div>
              <div class="user_info">
                  <p>請在地圖上點選滑鼠左鍵，建立您的店家所在位置。</p>
                  <!-- <form id="form" method="post" action="#.php">  -->
                    <div id="form">
                      <!-- <input onclick="deleteMarkers();" type="button" value="重新建立位置" />
                      <input type="submit" value="確認送出" id="submit">   -->
                    </div>
                  <!-- </form> -->
              </div>
            
          </div>
        </div>
        <div class="page page5">
          <h2>店家卡完成</h2>
          <div class="pageItem">
  
          </div>
        </div>
      </div>
      <div class="ctrlBtns">
          <button type="button" id="prevBtn" class="btn-rect_gr2">上一步</button>
          <button type="button" id="nextBtn" class="btn-rect_pk2">下一步</button>
        </div> 
    </form>
  </div>


  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <!-- map -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=&callback=initMap"></script>
  <script>
  let map;
let markers = [];        
const image ="./img/create/vendor2.png";
// 限制地圖觀看範圍只在夜市附近(1)
//     const ChungliNightMarket_Map_Boundary = {
//         north: 24.962399017033672,
//         south: 24.95570693350778,
//         west: 121.21120964864063,
//         east: 121.21965324261951,
//   };
function initMap() {
    const ChungliNightMarket = {lat: 24.96015215165077, lng: 121.2154904542284,};
    map = new google.maps.Map(document.getElementById("map"), {
        zoom: 17,
        center: ChungliNightMarket,
        mapTypeId: "roadmap",
    // 限制地圖觀看範圍只在夜市附近(2)
        // restriction: {
        //     latLngBounds: ChungliNightMarket_Map_Boundary,
        //     strictBounds: false,
        // },               
        
    }); 
    // 關閉原本地圖上的預設店家及其他指標
        const styles = {
            hide: [
                {
                featureType: "poi.business",
                stylers: [{ visibility: "off" }]
                },
                {
                featureType: "transit",
                elementType: "labels.icon",
                stylers: [{ visibility: "off" }]
                }
            ],
        }
        map.setOptions({
        styles: styles["hide"]
    });

    // 點擊建立店家所在位置 + 擷取建立位置的經度及緯度
    let position = document.createElement("div");
    document.querySelector("#form").appendChild(position);
    map.addListener("click", event => {
      document.querySelector('.user_info').style.display="none";
      deleteMarkers(event.latLng);
      addMarker(event.latLng);
      let A = event.latLng.lng().toFixed(6);
      let B = event.latLng.lat().toFixed(6);                  
      position.innerHTML = 
      `<input type="hidden" name="longitude" value="${A}"> <br>
      <input type="hidden" name="latitude" value="${B}"> `;
      
    });
} 


// Adds a marker to the map and push to the array.
function addMarker(location) {
    const marker = new google.maps.Marker({
        position: location,
        title:"娘娘雞排", //抓攤商於前面步驟輸入的值 (店名)
        map: map,
        icon:image,
        draggable: true,
    });
    const contentString =
      '<div id="content">' +
      '<div id="siteNotice"></div>'+
      '<h1>娘娘雞排</h1>' + // 抓攤商於前面步驟輸入的值 (店名)
      '<div id="bodyContent">' +
      "<p>我是攤商說明文字我是攤商說明文字我是攤商說明文字我是攤商說明文字我是攤商說明文字我是攤商說明文字</p>" +//抓攤商於前面步驟輸入的值 (店家簡介)
      "</div>" +
      "</div>";
      const infowindow = new google.maps.InfoWindow({
      content: contentString
      });
      marker.addListener("click", () => {
      infowindow.open(map, marker);
      });
  markers.push(marker);
} 

// Sets the map on all markers in the array.
function setMapOnAll(map) {
    for (let i = 0; i < markers.length; i++) {
        markers[i].setMap(map);
    }
} 

// Removes the markers from the map, but keeps them in the array.
function clearMarkers() {
    setMapOnAll(null);
} 

     
// Deletes all markers in the array by removing references to them.
function deleteMarkers() {
    clearMarkers();
    markers = [];
}

  </script>
<script src="./js/layout.js"></script>
</body>
</html>